<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pembobotan Kriteria AHP</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md">
      <h1 class="text-2xl font-bold mb-4">Pembobotan Kriteria (AHP)</h1>
      <p class="mb-4 text-gray-600">
        Pilih seberapa penting satu kriteria dibandingkan dengan kriteria
        lainnya.
      </p>

      {% if error_message %}
      <div
        class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
        role="alert"
      >
        <strong class="font-bold">Error!</strong>
        <span class="block sm:inline">{{ error_message }}</span>
      </div>
      {% endif %} {% if kriteria_list and kriteria_list|length >= 2 %}
      <form method="post">
        {% csrf_token %}
        <div class="overflow-x-auto">
          <table class="min-w-full bg-white border">
            <thead class="bg-gray-200">
              <tr>
                <th class="py-2 px-4 border">Kriteria</th>
                {% for kriteria in kriteria_list %}
                <th class="py-2 px-4 border">{{ kriteria.nama_kriteria }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for row_kriteria in kriteria_list %}
              <tr>
                <td class="py-2 px-4 border font-semibold bg-gray-200">
                  {{ row_kriteria.nama_kriteria }}
                </td>
                {% for col_kriteria in kriteria_list %}
                <td class="py-2 px-4 border">
                  {% if forloop.counter0 == forloop.parentloop.counter0 %}
                  <input
                    type="number"
                    value="1"
                    class="w-full p-1 border rounded bg-gray-200"
                    readonly
                  />
                  {% elif forloop.counter0 < forloop.parentloop.counter0 %}
                  <input
                    type="number"
                    step="any"
                    value="1"
                    id="matrix_{{ forloop.parentloop.counter0 }}_{{ forloop.counter0 }}"
                    name="matrix_{{ forloop.parentloop.counter0 }}_{{ forloop.counter0 }}"
                    class="w-full p-1 border rounded"
                    oninput="updateReciprocal(this)"
                  />
                  {% else %}
                  <input
                    type="number"
                    value="1"
                    id="matrix_{{ forloop.parentloop.counter0 }}_{{ forloop.counter0 }}"
                    class="w-full p-1 border rounded bg-gray-200"
                    readonly
                  />
                  {% endif %}
                </td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <button
          type="submit"
          class="mt-6 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
        >
          Hitung Bobot
        </button>
      </form>
      {% endif %}
    </div>

    <script>
      function updateReciprocal(input) {
        const i = input.id.split('_')[1];
        const j = input.id.split('_')[2];
        const reciprocalInput = document.getElementById(`matrix_${j}_${i}`);

        if (reciprocalInput && parseFloat(input.value) !== 0) {
          reciprocalInput.value = 1 / parseFloat(input.value);
        }
      }
    </script>
  </body>
</html>
